Version 4
SHEET 1 1508 680
WIRE 1344 -48 800 -48
WIRE 64 0 -16 0
WIRE 224 0 64 0
WIRE 384 0 224 0
WIRE 1344 32 1344 -48
WIRE 384 64 384 0
WIRE 224 80 224 0
WIRE 336 80 288 80
WIRE -16 128 -16 0
WIRE 1344 160 1344 112
WIRE 512 176 496 176
WIRE 640 176 592 176
WIRE 736 176 720 176
WIRE 224 208 224 160
WIRE 288 208 288 80
WIRE 288 208 224 208
WIRE 1056 224 1008 224
WIRE 384 240 384 160
WIRE 496 240 496 176
WIRE 496 240 384 240
WIRE 560 240 496 240
WIRE 704 240 640 240
WIRE 736 240 736 176
WIRE 736 240 704 240
WIRE 800 240 800 -48
WIRE 800 240 736 240
WIRE 1152 240 1120 240
WIRE 1296 240 1232 240
WIRE -16 256 -16 208
WIRE 1056 256 992 256
WIRE 1344 288 1344 256
WIRE 1424 288 1344 288
WIRE 992 320 992 256
WIRE 1344 320 1344 288
WIRE 384 336 384 240
WIRE 704 336 704 240
WIRE 992 448 992 400
WIRE 1344 448 1344 400
WIRE 384 464 384 400
WIRE 704 464 704 400
FLAG -16 256 0
FLAG 384 464 0
FLAG 704 464 0
FLAG 1344 448 0
FLAG 64 0 3.3
FLAG 1088 208 3.3
FLAG 1088 272 0
FLAG 992 448 0
FLAG 1424 288 Vfb
FLAG 1008 224 Vfb
SYMBOL voltage -16 112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 3.3
SYMBOL pmos 336 160 M180
SYMATTR InstName M1
SYMATTR Value AO6407
SYMBOL diode 400 400 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMBOL ind 544 256 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 47µ
SYMATTR SpiceLine Rser=1
SYMBOL cap 720 400 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL voltage 224 64 R0
WINDOW 3 -480 523 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(0 3.3 1m 10n 10n {((35*Iset+.2)/3.3)/100e3} {1/100e3})
SYMATTR InstName V2
SYMBOL res 1328 304 R0
SYMATTR InstName R3
SYMATTR Value {Rs}
SYMBOL voltage 992 304 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {Rs*Iset}
SYMBOL res 1328 16 R0
SYMATTR InstName R4
SYMATTR Value 32
SYMBOL OpAmps\\UniversalOpAmp2 1088 240 R0
SYMATTR InstName U2
SYMBOL res 1248 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 1
SYMBOL nmos 1296 160 R0
SYMATTR InstName M2
SYMATTR Value Si4866DY
SYMBOL ind 624 192 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 1µ
SYMATTR SpiceLine Rser=1
SYMBOL res 608 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value .5
TEXT 616 32 Left 2 !.tran 3m startup
TEXT 1056 528 Left 2 !.param Rs = 5
TEXT 664 600 Left 2 ;.step param Iset 10m 85m 10m
TEXT 1184 616 Left 2 !.param Iset 10m
